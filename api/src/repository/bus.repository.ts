import dayjs from 'dayjs';
import type { Brand } from '../types/utils';
import { toBrand } from '../utils';

interface ModeMap {
  [key: string]: string | null;
}

type Hour = 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 | 13 | 14 | 15 | 16 | 17 | 18 | 19 | 20 | 21 | 22 | 23;
interface TimeTable {
  [key: string]: {
    [key in Hour]: number[];
  };
}

export type Mode = Brand<'mode', string | null>;

export class BusRepository {
  private mode: ModeMap = {
    '2025-4-1': 'C',
    '2025-4-2': 'C',
    '2025-4-3': 'A',
    '2025-4-4': 'A',
    '2025-4-5': null,
    '2025-4-6': null,
    '2025-4-7': 'A',
    '2025-4-8': 'A',
    '2025-4-9': 'A',
    '2025-4-10': 'A',
    '2025-4-11': 'A',
    '2025-4-12': null,
    '2025-4-13': null,
    '2025-4-14': 'A',
    '2025-4-15': 'A',
    '2025-4-16': 'A',
    '2025-4-17': 'A',
    '2025-4-18': 'A',
    '2025-4-19': null,
    '2025-4-20': null,
    '2025-4-21': 'A',
    '2025-4-22': 'A',
    '2025-4-23': 'A',
    '2025-4-24': 'A',
    '2025-4-25': 'A',
    '2025-4-26': null,
    '2025-4-27': null,
    '2025-4-28': 'A',
    '2025-4-29': 'A',
    '2025-4-30': 'A',
    '2025-5-1': null,
    '2025-5-2': null,
    '2025-5-3': null,
    '2025-5-4': null,
    '2025-5-5': null,
    '2025-5-6': null,
    '2025-5-7': 'A',
    '2025-5-8': 'A',
    '2025-5-9': 'A',
    '2025-5-10': null,
    '2025-5-11': null,
    '2025-5-12': 'A',
    '2025-5-13': 'A',
    '2025-5-14': 'A',
    '2025-5-15': 'A',
    '2025-5-16': 'A',
    '2025-5-17': null,
    '2025-5-18': null,
    '2025-5-19': 'A',
    '2025-5-20': 'A',
    '2025-5-21': 'A',
    '2025-5-22': 'A',
    '2025-5-23': 'A',
    '2025-5-24': null,
    '2025-5-25': null,
    '2025-5-26': 'A',
    '2025-5-27': 'A',
    '2025-5-28': 'A',
    '2025-5-29': 'A',
    '2025-5-30': 'A',
    '2025-5-31': null,
    '2025-6-1': null,
    '2025-6-2': 'A',
    '2025-6-3': 'A',
    '2025-6-4': 'A',
    '2025-6-5': 'A',
    '2025-6-6': 'A',
    '2025-6-7': 'A',
    '2025-6-8': null,
    '2025-6-9': 'A',
    '2025-6-10': 'A',
    '2025-6-11': 'A',
    '2025-6-12': 'A',
    '2025-6-13': 'A',
    '2025-6-14': null,
    '2025-6-15': null,
    '2025-6-16': 'A',
    '2025-6-17': 'A',
    '2025-6-18': 'A',
    '2025-6-19': 'A',
    '2025-6-20': 'A',
    '2025-6-21': null,
    '2025-6-22': null,
    '2025-6-23': 'A',
    '2025-6-24': 'A',
    '2025-6-25': 'A',
    '2025-6-26': 'A',
    '2025-6-27': 'A',
    '2025-6-28': null,
    '2025-6-29': null,
    '2025-6-30': 'A',
    '2025-7-1': 'A',
    '2025-7-2': 'A',
    '2025-7-3': 'A',
    '2025-7-4': 'A',
    '2025-7-5': null,
    '2025-7-6': null,
    '2025-7-7': 'A',
    '2025-7-8': 'A',
    '2025-7-9': 'A',
    '2025-7-10': 'A',
    '2025-7-11': 'A',
    '2025-7-12': 'A',
    '2025-7-13': 'A',
    '2025-7-14': 'A',
    '2025-7-15': 'A',
    '2025-7-16': 'A',
    '2025-7-17': 'A',
    '2025-7-18': 'A',
    '2025-7-19': null,
    '2025-7-20': null,
    '2025-7-21': 'A',
    '2025-7-22': 'A',
    '2025-7-23': 'A',
    '2025-7-24': 'A',
    '2025-7-25': 'A',
    '2025-7-26': 'A',
    '2025-7-27': 'A',
    '2025-7-28': 'A',
    '2025-7-29': 'A',
    '2025-7-30': 'A',
    '2025-7-31': 'A',
    '2025-8-1': 'A',
    '2025-8-2': null,
    '2025-8-3': null,
    '2025-8-4': 'A',
    '2025-8-5': 'A',
    '2025-8-6': 'A',
    '2025-8-7': 'C',
    '2025-8-8': 'C',
    '2025-8-9': null,
    '2025-8-10': null,
    '2025-8-11': null,
    '2025-8-12': null,
    '2025-8-13': null,
    '2025-8-14': null,
    '2025-8-15': null,
    '2025-8-16': null,
    '2025-8-17': null,
    '2025-8-18': 'C',
    '2025-8-19': 'C',
    '2025-8-20': 'C',
    '2025-8-21': 'C',
    '2025-8-22': 'C',
    '2025-8-23': null,
    '2025-8-24': null,
    '2025-8-25': 'C',
    '2025-8-26': 'C',
    '2025-8-27': 'C',
    '2025-8-28': 'C',
    '2025-8-29': 'C',
    '2025-8-30': null,
    '2025-8-31': null,
    '2025-9-1': 'C',
    '2025-9-2': 'C',
    '2025-9-3': 'C',
    '2025-9-4': 'C',
    '2025-9-5': 'C',
    '2025-9-6': null,
    '2025-9-7': null,
    '2025-9-8': 'C',
    '2025-9-9': 'C',
    '2025-9-10': 'C',
    '2025-9-11': 'C',
    '2025-9-12': 'C',
    '2025-9-13': null,
    '2025-9-14': null,
    '2025-9-15': null,
    '2025-9-16': 'C',
    '2025-9-17': 'C',
    '2025-9-18': 'A',
    '2025-9-19': 'B',
    '2025-9-20': null,
    '2025-9-21': null,
    '2025-9-22': 'A',
    '2025-9-23': null,
    '2025-9-24': 'A',
    '2025-9-25': 'A',
    '2025-9-26': 'A',
    '2025-9-27': null,
    '2025-9-28': null,
    '2025-9-29': 'A',
    '2025-9-30': 'A',
    '2025-10-1': 'A',
    '2025-10-2': 'A',
    '2025-10-3': 'A',
    '2025-10-4': null,
    '2025-10-5': null,
    '2025-10-6': 'A',
    '2025-10-7': 'A',
    '2025-10-8': 'A',
    '2025-10-9': 'B',
    '2025-10-10': 'B',
    '2025-10-11': 'A',
    '2025-10-12': 'A',
    '2025-10-13': null,
    '2025-10-14': 'A',
    '2025-10-15': 'A',
    '2025-10-16': 'A',
    '2025-10-17': 'A',
    '2025-10-18': 'A',
    '2025-10-19': null,
    '2025-10-20': 'A',
    '2025-10-21': 'A',
    '2025-10-22': 'A',
    '2025-10-23': 'A',
    '2025-10-24': 'A',
    '2025-10-25': 'A',
    '2025-10-26': 'A',
    '2025-10-27': 'A',
    '2025-10-28': 'A',
    '2025-10-29': 'A',
    '2025-10-30': 'A',
    '2025-10-31': 'B',
    '2025-11-1': 'A',
    '2025-11-2': 'A',
    '2025-11-3': 'A',
    '2025-11-4': 'A',
    '2025-11-5': 'A',
    '2025-11-6': 'A',
    '2025-11-7': 'A',
    '2025-11-8': 'A',
    '2025-11-9': 'A',
    '2025-11-10': 'A',
    '2025-11-11': 'A',
    '2025-11-12': 'A',
    '2025-11-13': null,
    '2025-11-14': 'A',
    '2025-11-15': 'A',
    '2025-11-16': null,
    '2025-11-17': 'A',
    '2025-11-18': 'A',
    '2025-11-19': 'A',
    '2025-11-20': 'A',
    '2025-11-21': 'A',
    '2025-11-22': 'A',
    '2025-11-23': null,
    '2025-11-24': 'A',
    '2025-11-25': 'A',
    '2025-11-26': 'A',
    '2025-11-27': 'A',
    '2025-11-28': 'A',
    '2025-11-29': 'A',
    '2025-11-30': 'A',
    '2025-12-1': 'A',
    '2025-12-2': 'A',
    '2025-12-3': 'A',
    '2025-12-4': 'A',
    '2025-12-5': 'A',
    '2025-12-6': null,
    '2025-12-7': null,
    '2025-12-8': 'A',
    '2025-12-9': 'A',
    '2025-12-10': 'A',
    '2025-12-11': 'A',
    '2025-12-12': 'A',
    '2025-12-13': 'A',
    '2025-12-14': null,
    '2025-12-15': 'A',
    '2025-12-16': 'A',
    '2025-12-17': 'A',
    '2025-12-18': 'A',
    '2025-12-19': 'A',
    '2025-12-20': null,
    '2025-12-21': null,
    '2025-12-22': 'A',
    '2025-12-23': 'A',
    '2025-12-24': 'A',
    '2025-12-25': 'A',
    '2025-12-26': null,
    '2025-12-27': null,
    '2025-12-28': null,
    '2025-12-29': null,
    '2025-12-30': null,
    '2025-12-31': null,
    '2027-1-1': null,
    '2027-1-2': null,
    '2027-1-3': null,
    '2027-1-4': null,
    '2027-1-5': null,
    '2027-1-6': 'C',
    '2027-1-7': 'C',
    '2027-1-8': 'A',
    '2027-1-9': 'A',
    '2027-1-10': null,
    '2027-1-11': null,
    '2027-1-12': null,
    '2027-1-13': 'A',
    '2027-1-14': 'A',
    '2027-1-15': 'A',
    '2027-1-16': 'A',
    '2027-1-17': 'A',
    '2027-1-18': 'A',
    '2027-1-19': 'A',
    '2027-1-20': 'A',
    '2027-1-21': null,
    '2027-1-22': 'A',
    '2027-1-23': 'A',
    '2027-1-24': null,
    '2027-1-25': null,
    '2027-1-26': 'C',
    '2027-1-27': 'A',
    '2027-1-28': 'A',
    '2027-1-29': 'A',
    '2027-1-30': 'A',
    '2027-1-31': null,
    '2027-2-1': null,
    '2027-2-2': 'A',
    '2027-2-3': 'A',
    '2027-2-4': 'A',
    '2027-2-5': 'A',
    '2027-2-6': 'A',
    '2027-2-7': null,
    '2027-2-8': null,
    '2027-2-9': 'A',
    '2027-2-10': 'C',
    '2027-2-11': null,
    '2027-2-12': 'C',
    '2027-2-13': 'C',
    '2027-2-14': null,
    '2027-2-15': null,
    '2027-2-16': 'C',
    '2027-2-17': 'C',
    '2027-2-18': 'C',
    '2027-2-19': 'C',
    '2027-2-20': 'C',
    '2027-2-21': null,
    '2027-2-22': null,
    '2027-2-23': null,
    '2027-2-24': 'C',
    '2027-2-25': 'C',
    '2027-2-26': 'C',
    '2027-2-27': 'C',
    '2027-2-28': null,
    '2027-3-1': null,
    '2027-3-2': 'C',
    '2027-3-3': 'C',
    '2027-3-4': 'A',
    '2027-3-5': 'C',
    '2027-3-6': 'C',
    '2027-3-7': 'A',
    '2027-3-8': 'A',
    '2027-3-9': 'C',
    '2027-3-10': 'C',
    '2027-3-11': 'C',
    '2027-3-12': 'C',
    '2027-3-13': 'C',
    '2027-3-14': null,
    '2027-3-15': null,
    '2027-3-16': 'C',
    '2027-3-17': 'C',
    '2027-3-18': 'C',
    '2027-3-19': 'C',
    '2027-3-20': null,
    '2027-3-21': null,
    '2027-3-22': null,
    '2027-3-23': 'A',
    '2027-3-24': 'C',
    '2027-3-25': 'C',
    '2027-3-26': 'C',
    '2027-3-27': 'C',
    '2027-3-28': null,
    '2027-3-29': null,
    '2027-3-30': 'C',
    '2027-3-31': 'C',
  };

  private timeTable: TimeTable = {
    A1: {
      0: [],
      1: [],
      2: [],
      3: [],
      4: [],
      5: [],
      6: [],
      7: [],
      8: [0, 5, 10, 15, 20, 25, 30, 35, 40, 45, 50, 55],
      9: [0, 5, 10, 15, 20, 25, 30, 35, 40, 50, 55],
      10: [0, 5, 10, 15, 20, 25, 30, 35, 45, 55],
      11: [5, 15, 25, 35, 45, 55],
      12: [5, 15, 25, 35, 45, 55],
      13: [5, 20, 35, 50],
      14: [5, 15, 25, 35, 45, 55],
      15: [5, 15, 30, 45],
      16: [0, 15, 30, 45],
      17: [0, 10, 25, 40],
      18: [0, 15, 45],
      19: [0, 15, 30, 45],
      20: [0, 30],
      21: [0],
      22: [],
      23: [],
    },
    A2: {
      0: [],
      1: [],
      2: [],
      3: [],
      4: [],
      5: [],
      6: [],
      7: [],
      8: [20, 50],
      9: [20, 50],
      10: [20, 50],
      11: [0, 10, 20, 30, 40, 50],
      12: [0, 10, 20, 30, 40, 50],
      13: [0, 15, 30, 45],
      14: [0, 10, 20, 30, 40, 45, 50, 55],
      15: [0, 10, 20, 30, 40, 50],
      16: [0, 5, 10, 15, 25, 30, 35, 40, 45, 50, 55],
      17: [0, 10, 15, 20, 25, 30, 35, 40, 45, 55],
      18: [0, 10, 20, 30, 40, 50],
      19: [0, 15, 30, 45],
      20: [0, 15, 30, 45],
      21: [0, 15, 30, 45],
      22: [],
      23: [],
    },
    B1: {
      0: [],
      1: [],
      2: [],
      3: [],
      4: [],
      5: [],
      6: [],
      7: [],
      8: [0, 10, 20, 35, 45],
      9: [0, 5, 25, 35, 50],
      10: [0, 10, 30, 55],
      11: [0, 25, 50],
      12: [25],
      13: [35],
      14: [5, 35],
      15: [5, 35],
      16: [5, 45],
      17: [10, 45],
      18: [5, 35],
      19: [35],
      20: [25],
      21: [5],
      22: [],
      23: [],
    },
    B2: {
      0: [],
      1: [],
      2: [],
      3: [],
      4: [],
      5: [],
      6: [],
      7: [],
      8: [50],
      9: [40],
      10: [5, 50],
      11: [15, 40],
      12: [10],
      13: [20, 50],
      14: [20, 50],
      15: [20, 50],
      16: [20],
      17: [0, 30, 55],
      18: [20, 50],
      19: [20, 50],
      20: [40],
      21: [30],
      22: [],
      23: [],
    },
    C1: {
      0: [],
      1: [],
      2: [],
      3: [],
      4: [],
      5: [],
      6: [],
      7: [],
      8: [10, 35],
      9: [0, 25, 50],
      10: [10, 55],
      11: [25, 50],
      12: [25],
      13: [35],
      14: [5, 35],
      15: [5, 35],
      16: [5, 45],
      17: [10, 45],
      18: [5, 35],
      19: [35],
      20: [25],
      21: [5],
      22: [],
      23: [],
    },
    C2: {
      0: [],
      1: [],
      2: [],
      3: [],
      4: [],
      5: [],
      6: [],
      7: [],
      8: [50],
      9: [40],
      10: [5, 50],
      11: [15, 40],
      12: [10],
      13: [20, 50],
      14: [20, 50],
      15: [20, 50],
      16: [20],
      17: [0, 30, 55],
      18: [20, 50],
      19: [20, 50],
      20: [40],
      21: [30],
      22: [],
      23: [],
    },
  };

  getMode(date: Date): Mode {
    const dateStr = dayjs(date).format('YYYY-M-D');
    const mode = this.mode[dateStr] ?? null;

    return toBrand<'mode', string | null>(mode);
  }
}
